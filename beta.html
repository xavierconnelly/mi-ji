<!DOCTYPE html>
<html>
  <head>
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.1.1/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.1.1/ScrollTrigger.min.js"></script>

    <style>
          * {
            margin: 0;
            box-border: box-sizing;
            -webkit-font-smoothing: antialiased !important;
            text-rendering: optimizeLegibility !important;
          }

          @font-face {
            font-family: "Andale";
            src: url("https://mi-ji.com.au/ANDALEMO.woff") format("woff");
          }

          * {
            margin: 0;
            box-sizing: border-box;
            font-family: "Andale", times;
            font-size: 0.9rem;
          }
      
          body {
            background: white;
            transition: 2s;
          }
          
          a {
            color: initial;
            text-decoration: none;
          }

          #scroll {
            width: 100vw;
            height: 500px;
            overflow-x: scroll;
          }

          container {
            height: ;
            width: 2000px;
            overflow: hidden;
            display: inline-block;
          }

          container > div {
            display: ;
          }

          footer {
            position: absolute;
            bottom: 0;
            width: 100%;
            transition: 2s;
          }

          footer div {
            width: 100%;
            display: flex;
            flex-wrap: wrap;
            align-items: end;
          }
          footer div p {
            width: 25%;
            padding: 10px 10px 10px 10px;
            text-align: left;
          }

          header {
            height: 40px;
            padding: 5px 10px;
            background: white;
            border-bottom: px solid pink;
            transition: 2s;
          }

          header p {
            float: left;
            line-height: 30px;
          }

          header img {
            float: right;
            height: 100%;
          }

          #office {
            order: 1;
          }

          #millie {
            order: 2;
          }

          #jimmy {
            order: 3;
          }

          #rego {
            order: 4;
          }

          @media only screen and (max-width: 600px) {
            * {
              font-size: 0.95em;
            }

            header p {
              line-height: unset;
              width: 50%;}
            
            footer div {
              align-items: flex-start;
              flex-flow: row wrap;
            }

            footer div p {
              padding: 10px;
              flex: 1 50%;
            }

            #office {
              order: 3;
            }

            #millie {
              order: 1;
            }

            #jimmy {
              order: 2;
            }

            #rego {
              order: 4;
            }
          }
    </style>
    
    <script>
        function focusDetails() {
        document.getElementById("gallery").style.display = "none";
        document.querySelector("body").style.background = "rgb(255, 80, 0)";
        document.querySelector(".highlight").style.color = "white";
      }

      function normalDetails() {
        document.getElementById("gallery").style.display = "block";
        document.querySelector("body").style.background = "";
        document.querySelector(".highlight").style.color = "";
      }
      </script>
    
    <script>
      
      import { gsap } from "gsap";
      import { ScrollTriggerPlugin } from "gsap/ScrollTriggerPlugin.js";
      gsap.registerPlugin(ScrollTrigger);

      let iteration = 0; // gets iterated when we scroll all the way to the end or start and wraps around - allows us to smoothly continue the playhead scrubbing in the correct direction.

      const spacing = 0.125,    // spacing of the cards (stagger)
        //snap = gsap.utils.snap(spacing), // we'll use this to snap the playhead on the seamlessLoop
        cards = gsap.utils.toArray('.cards .column'),
        seamlessLoop = buildSeamlessLoop(cards, spacing),
        wrapProgress = gsap.utils.wrap(0, 1),
        scrub = gsap.to(seamlessLoop, { // we reuse this tween to smoothly scrub the playhead on the seamlessLoop
          totalTime: 0,
          duration: 0.5,
          ease: "power3",
          paused: true
        }),
        trigger = ScrollTrigger.create({
          start: 0,
          onUpdate(self) {
            if (self.progress === 1 && self.direction > 0 && !self.wrapping) {
              wrapForward(self);
            } else if (self.progress < 1e-5 && self.direction < 0 && !self.wrapping) {
              wrapBackward(self);
            } else {
              scrub.vars.totalTime = (iteration + self.progress) * seamlessLoop.duration();
              scrub.invalidate().restart(); // to improve performance, we just invalidate and restart the same tween. No need for overwrites or creating a new tween on each update.
              self.wrapping = false;
            }
          },
          end: "+=3000",
          pin: ".gallery"
        });

      function wrapForward(trigger, progress) { // when the ScrollTrigger reaches the end, loop back to the beginning seamlessly
        iteration++;
        trigger.wrapping = true;
        trigger.scroll(progress ? trigger.start + progress * (trigger.end - trigger.start) : trigger.start + 1);
      }

      function wrapBackward(trigger, progress) { // when the ScrollTrigger reaches the start again (in reverse), loop back to the end seamlessly
        iteration--;
        if (iteration < 0) { // to keep the playhead from stopping at the beginning, we jump ahead 10 iterations
          iteration = 9;
          seamlessLoop.totalTime(seamlessLoop.totalTime() + seamlessLoop.duration() * 10);
          scrub.pause(); // otherwise it may update the totalTime right before the trigger updates, making the starting value different than what we just set above.
        }
        trigger.wrapping = true;
        trigger.scroll(progress ? trigger.start + progress * (trigger.end - trigger.start) : trigger.end - 1);
      }

      function scrubTo(totalTime) { // moves the scroll position to the place that corresponds to the totalTime value of the seamlessLoop, and wraps if necessary.
        let progress = (totalTime - seamlessLoop.duration() * iteration) / seamlessLoop.duration();
        if (progress > 1) {
          wrapForward(trigger, wrapProgress(progress));
        } else if (progress < 0) {
          wrapBackward(trigger, wrapProgress(progress));
        } else {
          trigger.scroll(trigger.start + progress * (trigger.end - trigger.start));
        }
      }


      function buildSeamlessLoop(items, spacing) {
        let overlap = Math.ceil(1 / spacing), // number of EXTRA animations on either side of the start/end to accommodate the seamless looping
          startTime = items.length * spacing + 0.5, // the time on the rawSequence at which we'll start the seamless loop
          loopTime = (items.length + overlap) * spacing + 1, // the spot at the end where we loop back to the startTime 
          rawSequence = gsap.timeline({paused: true}), // this is where all the "real" animations live
          seamlessLoop = gsap.timeline({ // this merely scrubs the playhead of the rawSequence so that it appears to seamlessly loop
            paused: true,
            repeat: -1, // to accommodate infinite scrolling/looping
            onRepeat() { // works around a super rare edge case bug that's fixed GSAP 3.6.1
              this._time === this._dur && (this._tTime += this._dur - 0.01);
            }
          }),
          l = items.length + overlap * 2,
          time = 0,
          i, index, item;

        // set initial state of items
        gsap.set(items, {xPercent: 300});

        // now loop through and create all the animations in a staggered fashion. Remember, we must create EXTRA animations at the end to accommodate the seamless looping.
        for (i = 0; i < l; i++) {
          index = i % items.length;
          item = items[index];
          time = i * spacing;
          rawSequence.fromTo(item, {xPercent: 400}, {xPercent: -400, duration: 1, ease: "none", immediateRender: false}, time);
        }
        
        // here's where we set up the scrubbing of the playhead to make it appear seamless. 
        rawSequence.time(startTime);
        seamlessLoop.to(rawSequence, {
          time: loopTime,
          duration: loopTime - startTime,
          ease: "none"
        }).fromTo(rawSequence, {time: overlap * spacing + 1}, {
          time: startTime,
          duration: startTime - (overlap * spacing + 1),
          immediateRender: false,
          ease: "none"
        });
        return seamlessLoop;
      }
      </script>

  <head>

  <body>

    <header>
      <p>
        Office MIâ€”JI is an architectural office
      </p>
      <img src="https://mi-ji.com.au/images/OM_Brand_Mark_Black_Small_F.png">
    </header>

    <div class="gallery">
      <div class="cards">

        <div class="column pink">
          <div class="carousel">
            <div class="active horse">
              <img class="blur" src="https://mi-ji.com.au/images/ACertainKindofLife/01_650_blur.JPG">
              <img class="clear" src="https://mi-ji.com.au/images/ACertainKindofLife/01_650.JPG">
            </div>
            <div class="horse plan">
              <img class="clear" src="https://mi-ji.com.au/images/ACertainKindofLife/Plan_650.JPG">
            </div>
          </div>
          <div>
            <span class="words">A Certain Kind of Life - Lisbon, Portugal 2019 (Jimmy Carter with Abigail Chang, Francesco Marullo and Agata Siemionow in conjunction with the University of Illinois at Chicago.)</span>
          </div>
        </div>

        <div class="column grey">
          <div class="carousel">
            <div class="active horse">
              <img class="blur" src="https://mi-ji.com.au/images/ABHouse/02_650_blur.JPG">
              <img class="clear" src="https://mi-ji.com.au/images/ABHouse/02_650.JPG">
            </div>
          </div>
          <div>
            <span class="words">A BÂ HouseÂ - Barwon Heads, Australia 2021</span>
          </div>
        </div>

        <div class="column pink">
          <div class="carousel">
            <div class="active horse">
              <img class="blur" src="https://mi-ji.com.au/images/ACertainKindofLife/04_650_blur.JPG">
              <img class="clear" src="https://mi-ji.com.au/images/ACertainKindofLife/04_650.JPG">
            </div>
            <div class="horse plan">
              <img class="clear" src="https://mi-ji.com.au/images/ACertainKindofLife/Plan_650.JPG">
            </div>
          </div>
          <div>
            <span class="words">A Certain Kind of Life - Lisbon, Portugal 2019 (Jimmy Carter with Abigail Chang, Francesco Marullo and Agata Siemionow in conjunction with the University of Illinois at Chicago.)</span>
          </div>
        </div>

        <div class="column green">
          <div class="carousel">
            <div class="active horse">
              <img class="blur" src="https://mi-ji.com.au/images/AHouseForOne/01_650_blur.JPG">
              <img class="clear" src="https://mi-ji.com.au/images/AHouseForOne/01_650.JPG">
            </div>
          </div>
          <div>
            <span class="words">A House For One â€“ Castlemaine, Australia 2016
            </span>
          </div>
        </div>

        <div class="column red">
          <div class="carousel">
            <div class="active horse">
              <img class="blur" src="https://mi-ji.com.au/images/TokyoTina/01_650_blur.JPG">
              <img class="clear" src="https://mi-ji.com.au/images/TokyoTina/01_650.JPG">
            </div>
          </div>
          <div>
            <span class="words">Tokyo Tina â€“ Prahran, Australia 2015</span>
          </div>
        </div>

        <div class="column yellow">
          <div class="carousel">
            <div class="active horse">
              <img class="blur" src="https://mi-ji.com.au/images/APavilion/01_650_blur.JPG">
              <img class="clear" src="https://mi-ji.com.au/images/APavilion/01_650.JPG">
            </div>
          </div>
          <div>
            <span class="words">A Pavilion - Collingwood, Australia 2021 (in collaboration with Molly Younger and Omid Jaffari)</span>
          </div>
        </div>

        <div class="column grey">
          <div class="carousel">
            <div class="active horse">
              <img class="blur" src="https://mi-ji.com.au/images/ABHouse/01_650_blur.JPG">
              <img class="clear" src="https://mi-ji.com.au/images/ABHouse/01_650.JPG">
            </div>
          </div>
          <div>
            <span class="words">A BÂ HouseÂ - Barwon Heads, Australia 2021</span>
          </div>
        </div>

        <div class="column green">
          <div class="carousel">
            <div class="active horse">
              <img class="blur" src="https://mi-ji.com.au/images/AHouseForOne/02_650_blur.JPG">
              <img class="clear" src="https://mi-ji.com.au/images/AHouseForOne/02_650.JPG">
            </div>
          </div>
          <div>
            <span class="words">A House For One â€“ Castlemaine, Australia 2016
            </span>
          </div>
        </div>

        <div class="column pink">
          <div class="carousel">
            <div class="active horse">
              <img class="blur" src="https://mi-ji.com.au/images/ACertainKindofLife/02_650_blur.JPG">
              <img class="clear" src="https://mi-ji.com.au/images/ACertainKindofLife/02_650.JPG">
            </div>
            <div class="horse plan">
              <img class="clear" src="https://mi-ji.com.au/images/ACertainKindofLife/Plan_650.JPG">
            </div>
          </div>
          <div>
            <span class="words">A Certain Kind of Life - Lisbon, Portugal 2019 (Jimmy Carter with Abigail Chang, Francesco Marullo and Agata Siemionow in conjunction with the University of Illinois at Chicago.)</span>
          </div>
        </div>

        <div class="column grey">
          <div class="carousel">
            <div class="active horse">
              <img class="blur" src="https://mi-ji.com.au/images/ABHouse/03_650_blur.JPG">
              <img class="clear" src="https://mi-ji.com.au/images/ABHouse/03_650.JPG">
            </div>
          </div>
          <div>
            <span class="words">A BÂ HouseÂ - Barwon Heads, Australia 2021</span>
          </div>
        </div>

        <div class="column green">
          <div class="carousel">
            <div class="active horse">
              <img class="blur" src="https://mi-ji.com.au/images/AHouseForOne/03_650_blur.JPG">
              <img class="clear" src="https://mi-ji.com.au/images/AHouseForOne/03_650.JPG">
            </div>
          </div>
          <div>
            <span class="words">A House For One â€“ Castlemaine, Australia 2016
            </span>
          </div>
        </div>

        <div class="column yellow">
          <div class="carousel">
            <div class="active horse">
              <img class="blur" src="https://mi-ji.com.au/images/APavilion/02_650_blur.JPG">
              <img class="clear" src="https://mi-ji.com.au/images/APavilion/02_650.JPG">
            </div>
          </div>
          <div>
            <span class="words">A Pavilion - Collingwood, Australia 2021 (in collaboration with Molly Younger and Omid Jaffari)</span>
          </div>
        </div>

        <div class="column pink">
          <div class="carousel">
            <div class="active horse">
              <img class="blur" src="https://mi-ji.com.au/images/ACertainKindofLife/03_650_blur.JPG">
              <img class="clear" src="https://mi-ji.com.au/images/ACertainKindofLife/03_650.JPG">
            </div>
            <div class="horse plan">
              <img class="clear" src="https://mi-ji.com.au/images/ACertainKindofLife/Plan_650.JPG">
            </div>
          </div>
          <div>
            <span class="words">A Certain Kind of Life - Lisbon, Portugal 2019 (Jimmy Carter with Abigail Chang, Francesco Marullo and Agata Siemionow in conjunction with the University of Illinois at Chicago.)</span>
          </div>
        </div>

        <div class="column grey">
          <div class="carousel">
            <div class="active horse">
              <img class="blur" src="https://mi-ji.com.au/images/ABHouse/04_650_blur.JPG">
              <img class="clear" src="https://mi-ji.com.au/images/ABHouse/04_650.JPG">
            </div>
          </div>
          <div>
            <span class="words">A BÂ HouseÂ - Barwon Heads, Australia 2021</span>
          </div>
        </div>

        <div class="column yellow">
          <div class="carousel">
            <div class="active horse">
              <img class="blur" src="https://mi-ji.com.au/images/APavilion/03_650_blur.JPG">
              <img class="clear" src="https://mi-ji.com.au/images/APavilion/03_650.JPG">
            </div>
          </div>
          <div>
            <span class="words">A Pavilion - Collingwood, Australia 2021 (in collaboration with Molly Younger and Omid Jaffari)</span>
          </div>
        </div>       

      </div>
    </div>

    <footer onmouseover="focusDetails()" onmouseout="normalDetails()">
      <div>
        <p id="office" class="highlight">
          Office MIâ€”JI<br>
          54 Johnston St <br>
          Collingwood 3066
        </p>
        <p id="millie">
          Millie Anderson<br>
          millie@mi-ji.com.au<br>
          0417 038 912
        </p>
        <p id="jimmy">
          Jimmy Carter<br>
          jimmy@mi-ji.com.au<br>
          0452 055 948
        </p>
        <p id="rego">
          <a href="https://instagram.com/office_mi.ji">IG</a><br>
          ARBV 52058
        </p>
      </div>
    </footer>
  </body>
</html>
